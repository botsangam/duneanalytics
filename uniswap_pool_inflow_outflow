SELECT
  DATE_TRUNC('day', evt_block_time) AS day,
  COUNT(evt_tx_hash) AS transaction_count,
  ROUND(SUM(value) / POWER(10, 18), 2) AS total_amount,
  CASE
    WHEN "from" = 0x965d10e86E831E501C08659261bcAE5FAfe715DE
    THEN 'outflow'
    WHEN "to" = 0x965d10e86E831E501C08659261bcAE5FAfe715DE
    THEN 'inflow'
    ELSE NULL
  END AS type
FROM erc20_arbitrum.evt_Transfer
WHERE
  contract_address = 0xfbbb21d8e7A461f06e5E27efD69703aCB5C732A8
  AND (
    "from" = 0x965d10e86E831E501C08659261bcAE5FAfe715DE
    OR "to" = 0x965d10e86E831E501C08659261bcAE5FAfe715DE
  )
GROUP BY
  1,
  CASE
    WHEN "from" = 0x965d10e86E831E501C08659261bcAE5FAfe715DE
    THEN 'outflow'
    WHEN "to" = 0x965d10e86E831E501C08659261bcAE5FAfe715DE
    THEN 'inflow'
    ELSE NULL
  END
ORDER BY
  day DESC;
